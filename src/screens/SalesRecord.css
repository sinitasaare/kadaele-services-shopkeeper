/* ============================================================
   SalesJournal.css
   ============================================================ */

/* --bar-height is set dynamically in JS via ResizeObserver on .sj-sticky-bar.
   It is written onto .sales-record so both the bar and the thead can
   reference the same value. Default 0px prevents any flash before JS runs. */
.sales-record {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  --bar-height: 0px;
}

/* ── Filter panel ── */
.filters-section {
  margin: 0 20px 12px;
  background-color: var(--surface);
  border: 1px solid var(--border);
  border-radius: 0.75rem;
  box-shadow: var(--shadow-md);
  padding: 1.25rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.filter-group { display: flex; flex-direction: column; gap: 0.5rem; }
.filter-group > label {
  font-size: 0.8125rem; font-weight: 600; color: var(--text-secondary);
  text-transform: uppercase; letter-spacing: 0.04em;
}
.filter-buttons { display: flex; flex-wrap: wrap; gap: 0.5rem; }

.filter-btn {
  padding: 0.4rem 0.875rem; font-size: 0.8125rem; font-weight: 500;
  background-color: var(--background); border: 1.5px solid var(--border);
  border-radius: 0.5rem; color: var(--text-primary); cursor: pointer;
  transition: all 0.2s ease;
}
.filter-btn:hover { border-color: #667eea; color: #667eea; }
.filter-btn.active {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-color: transparent; color: #ffffff;
}

.date-input {
  padding: 0.4rem 0.75rem; font-size: 0.875rem;
  border: 1.5px solid var(--border); border-radius: 0.5rem;
  background-color: var(--background); color: var(--text-primary);
  transition: border-color 0.2s ease;
}
.date-input:focus { border-color: #667eea; }
.date-input-disabled { opacity: 0.45; cursor: not-allowed; background-color: #f0f0f0; }

.date-range-inputs { display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; }
.date-range-field { display: flex; align-items: center; gap: 0.5rem; }
.date-range-label { font-size: 0.8125rem; font-weight: 500; color: var(--text-secondary); white-space: nowrap; }
.date-range-hint { font-size: 0.75rem; color: #a07ec0; font-style: italic; margin-top: 0.25rem; }

/* ── Sticky bar ─────────────────────────────────────────────────────────────
   This bar is NO LONGER position:sticky. Instead it sits in a flex column
   above .sj-scroll-body. It never scrolls because only .sj-scroll-body
   is the scroll container. This is 100% reliable on Android WebView.
────────────────────────────────────────────────────────────────────────── */
.sj-sticky-bar {
  flex-shrink: 0;           /* never grow or shrink — always its natural height */
  z-index: 50;
  background-color: var(--background, #f5f5f5);
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: 5px 0 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.filter-btn-wrapper {
  display: flex;
  justify-content: center;
  padding: 0 20px;
}

.sales-filter-action-btn {
  color: white; border: none; padding: 10px 20px; border-radius: 8px;
  font-size: 14px; font-weight: 600; cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  white-space: nowrap; display: inline-block;
}
/* Filter Sales — greenish purple */
.sales-filter-action-btn.sfab-open {
  background: linear-gradient(135deg, #5b4fcf 0%, #3d9970 100%);
  box-shadow: 0 2px 8px rgba(91,79,207,0.35);
}
.sales-filter-action-btn.sfab-open:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(91,79,207,0.45); }
/* Apply Filter — bluish purple */
.sales-filter-action-btn.sfab-apply {
  background: linear-gradient(135deg, #667eea 0%, #3b82f6 100%);
  box-shadow: 0 2px 8px rgba(59,130,246,0.35);
}
.sales-filter-action-btn.sfab-apply:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(59,130,246,0.45); }
/* Close Filter — reddish purple */
.sales-filter-action-btn.sfab-close {
  background: linear-gradient(135deg, #9b3fbf 0%, #e05252 100%);
  box-shadow: 0 2px 8px rgba(155,63,191,0.35);
}
.sales-filter-action-btn.sfab-close:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(155,63,191,0.45); }

.table-title {
  font-size: 1.294rem; font-weight: 600; color: #764ba2;
  margin: 0 20px; text-align: center;
}

.stats-boxes {
  display: flex;
  align-items: center;
  margin: 0 20px;
  gap: 8px;
}
.stat-box {
  display: flex; flex-direction: column; gap: 0.2rem;
  border-radius: 0.625rem; padding: 0.65rem 0.8rem;
  box-shadow: var(--shadow-sm); text-align: center; align-items: center;
}
.stat-box-purple {
  width: calc(32.5% * 0.65);   /* 35% narrower, float left */
  flex-shrink: 0;
}
.stat-box-green {
  width: calc(32.5% * 0.65 * 1.2);   /* Grand Total: 20% wider */
  flex-shrink: 0;
  margin-left: auto;
}
.stat-box-purple { background: linear-gradient(135deg, #4c3a8f 0%, #2d1b5e 100%); }
.stat-box-green  { background: linear-gradient(135deg, #0f6b50 0%, #064d38 100%); }
.stat-label {
  font-size: 0.65rem; font-weight: 600; color: #ffffff;
  text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.85; text-align: center;
}
.stat-value { font-size: 1.05rem; font-weight: 700; color: #ffffff; text-align: center; }

/* ── Scroll body ─────────────────────────────────────────────────────────────
   THE ONLY scroll container in SalesJournal. Scrolls both x and y.
   thead is sticky at top:0 within THIS container — 100% reliable on
   Android WebView because there is no intermediate overflow container.
────────────────────────────────────────────────────────────────────────── */
.sj-scroll-body {
  flex: 1;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

/* ── Table wrapper — visual chrome only, no overflow ── */
.table-wrapper {
  margin: 0 20px 20px;
  background-color: var(--surface);
  border-radius: 0.75rem;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
  min-width: max-content;
  width: calc(100% - 40px);
}

/* ── Sales table ── */
.sales-table {
  width: 100%;
  min-width: max-content;
  border-collapse: collapse;
  font-size: 0.875rem;
  table-layout: auto;
}

/* ── Sticky thead ────────────────────────────────────────────────────────────
   top:0 — sticks to the top of .sj-scroll-body (its scroll container).
   No JS needed to compute the top value anymore.
────────────────────────────────────────────────────────────────────────── */
.sj-thead {
  position: sticky;
  top: 0;
  z-index: 10;
}

.sj-thead th {
  padding: 0.75rem 1rem;
  text-align: left;
  font-weight: 600;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-secondary);
  background-color: #f8f9fa;
  border-bottom: 2px solid var(--border);
  white-space: nowrap;
}

/* ── Body rows ── */
.sales-table td {
  padding: 0.75rem 1rem;
  border-bottom: 1px solid var(--border);
  color: var(--text-primary);
  white-space: nowrap;
}
.sales-table tr:last-child td { border-bottom: none; }
.sales-table tbody tr:hover { background-color: rgba(102, 126, 234, 0.03); }

.col-qty { text-align: center !important; }
.items-cell { font-size: 0.8125rem; color: var(--text-secondary); }

.merged-cell {
  vertical-align: middle;
  border-bottom: 2px solid var(--border) !important;
}

.sale-first-row td { border-top: 2px solid rgba(102, 126, 234, 0.15); }
.sale-first-row:first-child td { border-top: none; }
.sale-continuation-row td { border-top: none; }

.payment-badge {
  display: inline-block; padding: 0.2rem 0.55rem; border-radius: 0.375rem;
  font-size: 0.7rem; font-weight: 700; letter-spacing: 0.04em;
}
.payment-cash   { background-color: #d1fae5; color: #065f46; }
.payment-credit { background-color: #fee2e2; color: #991b1b; }

.empty-cell {
  text-align: center; padding: 3rem 1rem;
  color: var(--text-secondary); font-style: italic;
}

/* ── Mobile ── */
@media (max-width: 768px) {
  .filters-section { margin: 0 15px 12px; }
  .filter-btn-wrapper { padding: 0 15px; }
  .table-title { margin: 0 15px; }
  .stats-boxes { margin: 0 15px; }
  .stat-box { width: 32.5%; padding: 0.55rem 0.6rem; }
  .stat-value { font-size: 0.9rem; }
  .table-wrapper { margin: 0 15px 15px; width: calc(100% - 30px); }
  .sj-thead th, .sales-table td { padding: 0.5rem 0.625rem; font-size: 0.75rem; }
  .date-range-inputs { flex-direction: column; align-items: flex-start; }
}

/* ── Dark Mode ─────────────────────────────────────────────────────────── */
[data-theme="dark"] .sales-table td { color: #ffffff; }
[data-theme="dark"] .sales-table th { color: #ffffff; }
[data-theme="dark"] .merged-cell { color: #ffffff; }
[data-theme="dark"] .items-cell { color: #ffffff; }
[data-theme="dark"] .empty-cell { color: #ffffff; }
